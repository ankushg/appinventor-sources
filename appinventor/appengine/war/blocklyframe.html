<!-- Copyright 2012 Massachusetts Institute of Technology. All Rights Reserved. -->

<!-- The contents of a blocks editor iframe in App Inventor -->
<html>
  <head>
    <script type="text/javascript" src="closure-library-20120710-r2029/closure/goog/base.js"></script>
    <link type="text/css" rel="stylesheet" href="media/blockly.css">
    <link type="text/css" rel="stylesheet" href="closure-library-20120710-r2029/closure/goog/css/dialog.css">
    <style>
      html, body {
      background-color: #fff;
      margin: 0;
      padding:0;
      overflow: hidden;
    }
    .blocklySvg {
      height: 100%;
      width: 100%;
    }
    </style>

    <script type="text/javascript">
      var formName = window.location.hash.substr(1);
      window.blocklyLoaded = false;

      function init() {
        // We expect window.location.hash to have the form:
        // projectId_formName, and to be unique among
        // all the Blockly instances created in this App Inventor session.
        if(blocklyLoaded){
          window.parent.BlocklyPanel_afterBlocklyInit(formName);
          return;
        }
        var head= document.getElementsByTagName('head')[0];
        var script = document.createElement("script");
        script.type = "text/javascript";
        script.src = "blockly-all.js";
        head.appendChild(script);
      }
      
      function loadInitFunction() {
        if(!window.parent.initFunctions) {
          window.parent.initFunctions = {};
        }

        window.parent.initFunctions[formName] = init;
      }
    </script>
  </head>
<body onload="loadInitFunction()"></body>
</html>
